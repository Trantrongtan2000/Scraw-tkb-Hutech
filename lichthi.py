#!/usr/bin/python
import re
import sys
import http.cookiejar, urllib.request
import requests
from bs4 import BeautifulSoup

cj = http.cookiejar.CookieJar()
opener = urllib.request.build_opener(urllib.request.HTTPCookieProcessor(cj))

URL="http://daotao.hutech.edu.vn/Default.aspx?page=dangnhap"
headers={"User-Agent":"Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/37.0.2062.120 Safari/537.36"}

username="Nhập tk"
password="Nhập mk"

s=requests.Session()
s.headers.update(headers)
r=s.get(URL)




login_data={"__VIEWSTATE":"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",
"ctl00$ContentPlaceHolder1$ctl00$txtTaiKhoa":username,
"ctl00$ContentPlaceHolder1$ctl00$txtMatKhau":password,
"ctl00$ContentPlaceHolder1$ctl00$btnDangNhap":"Đăng Nhập"}

def doituong(a1,a2,a3,a4,a5,a6):
    for t in range(1,5):
     cot="ctl00_ContentPlaceHolder1_ctl00_gvXem_ctl0"+str(t+1)+"_lbl"+str(a3)
     for tag in soup.find_all(str(a1), attrs={str(a2): cot,str(a4):str(a5)}):        
        t=tag.getText()
        a6.append(t)

r=s.post(URL, data=login_data)
s.headers.update(headers)
t = s.get("http://daotao.hutech.edu.vn/Default.aspx?page=xemlichthi")
soup = BeautifulSoup(t.text, "lxml")

t=[]
doituong("span","id","TenMonHoc","class","Label",t)
doituong("span","id","NgayThi","class","Label",t)
doituong("span","id","TietBD","class","Label",t)
doituong("span","id","TenPhong","class","Label",t)
hk="Lịch thi học kì 2A"
print(hk.center(100, '*'))
print('*'+" ".center(98)+'*')
for i in range(0,4):
    a=t[i]+", thi ngày "+t[i+4]+", lúc "+t[i+8]+" tại phòng "+t[i+12]
    while True:
     if len(a)<92:
        a=(a+"\t").expandtabs(1)
     elif len(a)==92:
         break
    print("* Môn: "+a+"*")
print('*'+" ".center(98)+'*')
print("".center(100,"*"))
